<!DOCTYPE html>
<html>
  <script src='https://d3js.org/d3.v5.min.js'></script>
  <body onload='init()'>
    <svg>
    </svg>
<script>
      async function init() {
        data = await d3.csv("https://flunky.github.io/cars2017.csv");
        
        
        var paddingAroundChart = 50;
        var canvasWidth = 400;
        var canvasHeight = 400;
        var axisFontSize = 18;
        cityMPG_scale = d3.scaleLog().base(10).domain([10,150]).range([0,canvasWidth - 2*paddingAroundChart]);
        hwyMPG_scale = d3.scaleLog().base(10).domain([10,150]).range([canvasHeight - 2*paddingAroundChart,0]);
        
        // scatter plot
        d3.select("svg")
        .attr("width", canvasWidth)
        .attr("height", canvasHeight)
          .append("g")
            .attr("transform", "translate(" + paddingAroundChart + "," + paddingAroundChart + ")")
            .attr("id", "chart-field")
            .selectAll("circle")
            .data(data)
            .enter()
            .append("circle")
            .attr("cx", function(d, i) {return cityMPG_scale(d.AverageCityMPG);})
            .attr("cy", function(d, i) {return hwyMPG_scale(d.AverageHighwayMPG);})
            .attr("r", function(d) {return Number(d.EngineCylinders)+2;})
            .style("fill", "lightblue")
            .style("opacity", 0.1)
            .style("stroke", "black");
        
        //y-axis
        d3.select("svg")
        .append("g")
        .attr("transform", "translate(" + paddingAroundChart +"," + paddingAroundChart +")")
        .call(d3.axisLeft(hwyMPG_scale)
              .tickFormat(d3.format("1.0s"))
              .tickValues([10,20,50,100])
             );
        
        // y-axis title
        d3.select("svg")
        .append("text")
        .attr("class", "y label")
        .attr("text-anchor", "middle")
        .attr("y", paddingAroundChart*2/5)
        .attr("x", -(canvasHeight/2))
        .attr("transform", "rotate(-90)")
          .attr("font-size", axisFontSize)
        .text("Average Highway MPG");
        
        
        // x-axis
        d3.select("svg")
        .append("g")
        .attr("transform", "translate(" + paddingAroundChart +"," + (canvasHeight - paddingAroundChart)  +")")
        .call(d3.axisBottom(cityMPG_scale)
              .tickFormat(d3.format("1.0s"))
              .tickValues([10,20,50,100]));
        
        // x-axis title
        d3.select("svg")
        .append("text")
        .attr("class", "x label")
        .attr("text-anchor", "middle")
        .attr("x", canvasWidth / 2)
        .attr("y", canvasHeight - 10)
        .attr("font-size", axisFontSize)
        .text("Average City MPG");
        
        
        
      }
    </script>
  </body>


</html>
